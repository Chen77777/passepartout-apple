name: 'Prepare build environment'
runs:
  using: 'composite'
  steps:
    - uses: ruby/setup-ruby@v1
      with:
        bundler-cache: true
    - uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: latest-stable
    - uses: actions/cache@v2
      with:
        path: .build
        key: ${{ runner.os }}-spm-${{ hashFiles('**/Package.resolved') }}
        restore-keys: |
          ${{ runner.os }}-spm-
    - shell: bash
      run: |
        scripts/ci/recognize-match-hostname.sh
        bundle exec fastlane preinstall_development_certs
